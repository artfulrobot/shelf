<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>ðŸ“– {title}</title>
    <style>
      body {
        font-family: Lato;
        margin: 0;
        padding: 0;
      }
      ul { padding-left: 1rem; }
      li { margin-bottom: 0.5rem; }
      li>ul, li>ol { padding-top: 0.5rem; }
      pre {
        margin: 1rem -1rem;
        padding: 1rem;
        border-radius: 4px;
        background: hsl(200, 29%, 93.9%);
        overflow: auto;
      }
      p>code {
        background: hsl(200, 29%, 93.9%);
        border: solid 1px hsl(200, 29%, 80%);
        padding: 0 0.5em;
      }
      header {
        background: #f8f8f8;
        padding: 1rem;
      }
      img {
        max-width: 100%;
        height: auto;
      }
      .path {
        font-size: calc(14rem/16);
      }
      .project-dir {
        opacity: 0.4;
      }
      .project-file {
        opacity: 0.9;
      }
      .main-content { max-width: 70ch; margin: 0 auto; }

      .index-content {padding: 0 2rem;}
      .projects {
        columns: 4;
      }
      .index-content article {
        background: hsl(200, 29%, 93.9%);
        padding: 1rem;
        margin-bottom: 1rem;
        page-break-inside: avoid;
      }
      .index-content article h2 {
        margin-top: 0;
      }
      .index-content article ul {
        padding-left: 1rem;
        max-height: calc(100vh - 8rem);
        overflow: auto;
      }
      a:link, a:visited {
        color: #0284ea;
        text-decoration: none;
      }
      a:active, a:hover {
        color: #02477d;
        text-decoration: none;
      }
    .shelf-index-header {
      display: flex;
      align-items: center;
    }
    .shelf-index-header h1 { flex: 1 0 auto; }
    .shelf-index-header form { flex: 0 0 auto; }
  a.clear-search {
    display: inline-block;
    padding: 0.25em 0.5em;
    text-decoration: none;
  }
    .hidden { display: none; }
    #hint { padding-right: 2ch; opacity: 0.8; }
    kbd { border: solid 1px #eee; background: #fefefe; padding: 0 0.5ch; border-radius: 3px; }

    </style>
  </head>
  <body>
    <div class="content">{content}</div>
  </body>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      let pageSearch = '<initial value>';
      let isIndexPage = document.querySelector('.shelf-index-header');
      let searchInput = document.querySelector('input[name="search"]');
      let hint = document.querySelector('#hint');
      if (isIndexPage) {
        searchInput.addEventListener('input', updatePageSearch);
        searchInput.focus();
        items = document.querySelectorAll('ul.pages>li');
        console.log({searchInput, items});
        updatePageSearch();
      }

      function updatePageSearch() {
        let updatedSearchText = searchInput.value.toLowerCase();
        // noop, e.g. cursor keys.
        if (updatedSearchText === pageSearch) return;
        pageSearch = updatedSearchText;

        if (pageSearch) {
          console.log({pageSearch});
          hint.classList.remove('hidden');
        }
        else {
          hint.classList.add('hidden');
        }

        items.forEach(li => {
          const matches = !!(pageSearch ? (li.textContent.toLocaleLowerCase().indexOf(pageSearch) > -1) : 1);
          // console.log({li,matches, lc: li.textContent.toLocaleLowerCase(), matches});
          if (li.matches !== matches) {
            li.matches = matches;
            if (matches) li.classList.remove('hidden');
            else li.classList.add('hidden');
          }
        });
      }
    });
  </script>
</html>
